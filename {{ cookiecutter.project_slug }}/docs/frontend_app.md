# Frontend App

## Overview

The 'Frontend App' uses [Create React App](https://github.com/facebook/create-react-app)
with [TypeScript](https://www.typescriptlang.org).

You can learn more in the
[Create React App documentation](https://facebook.github.io/create-react-app/docs/getting-started).

To learn React, check out the [React documentation](https://reactjs.org/).


## Running the dev server on your host machine

If you have `npm` installed on your host machine, you can start the dev server
by running `npm start`:

```
$ cd frontend_app
$ npm run start
```

You can then access the dev server at http://localhost:3000

The page will reload if you make edits. You will also see any lint errors in
the console.

Note: the `start` and `test` scripts in `package.json` have been extended
with a bash script to load some dev environment variables. If you want to run
the dev server directly on a Windows host you will need to use an alternative
to the Windows command prompt, such as Cygwin.

## Formatting

To run the [prettier](https://prettier.io) formatter:

```
$ npm run prettier
```

## Running Tests

You can run tests with:

```
$ npm run test
```

For more information see the Create React App documentation on
[running tests](https://create-react-app.dev/docs/running-tests).

## Creating a Production-Ready Build

A production-ready build of the frontend app is automatically generated by the
Ansible provisioning. This is an optimised and minified build which is ready to
be deployed.

If you want to see this build in action on the Podman dev environment, run:

```
./provision_dev_environment.sh
```

and visit https://localhost:5000 where it is being
served via NGINX on the 'frontend' podman container.

## Serving in Production

The production build of the frontend app is served with NGINX.

NGINX has been configured to redirect http requests to https. The contents of
`build/static/` are served as regular files, with all other urls served using
`index.html` if no file with a matching name is found.

NGINX has also been configured to serve the frontend app with 
[Content-Security-Policy](https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP)
headers as an added layer of security. The CSP header is set to only allow content
from the site's own origin. With this configuration, any other scripts will be
ignored by CSP-supporting browsers (e.g.: inline scripts, inline event handlers). 
